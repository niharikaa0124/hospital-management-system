{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Doctor-Patient Graph</title>
    <style>
        html, body { height: 100%; margin: 0; font-family: Arial; }
        #cy { width: 100%; height: 100vh; display: block; background: #f5f5f5; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/cytoscape/dist/cytoscape.min.js"></script>
</head>
<body>
<div id="cy"></div>

<script>
async function initGraph() {
    const res = await fetch("{% url 'doctor_patient_graph_data' %}");
    const elements = await res.json();

    const cy = cytoscape({
        container: document.getElementById('cy'),
        elements: elements,
        style: [
            {
                selector: 'node',
                style: {
                    'label': 'data(label)',
                    'background-color': 'data(color)',
                    'text-valign': 'center',
                    'color': '#fff',
                    'text-outline-width': 2,
                    'text-outline-color': '#555',
                    'width': 60,
                    'height': 60
                }
            },
            {
                selector: 'edge',
                style: {
                    'width': 3,
                    'line-color': '#ccc',
                    'target-arrow-color': '#ccc',
                    'target-arrow-shape': 'triangle',
                    'curve-style': 'bezier'
                }
            }
        ],
        layout: { name: 'cose', idealEdgeLength: 100, nodeOverlap: 20 }
    });

    cy.on('tap', 'node', function(evt){
        const node = evt.target;
        alert(`Node: ${node.data().label}\nType: ${node.data().type}`);
    });
}

initGraph();
</script>
</body>
</html>

